---
# YouTube Live Chat Collector - ã‚¯ã‚¤ãƒƒã‚¯ãƒ‡ãƒ—ãƒ­ã‚¤
# å€‹åˆ¥ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¿…é€Ÿãªãƒ‡ãƒ—ãƒ­ã‚¤ç”¨

- name: YouTube Live Chat Collector - Quick Deploy
  hosts: localhost
  connection: local
  gather_facts: no
  
  vars:
    # ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾è±¡é¸æŠï¼ˆã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã§æŒ‡å®šï¼‰
    # ansible-playbook quick-deploy.yml -e "component=lambda"
    # ansible-playbook quick-deploy.yml -e "component=container"
    # ansible-playbook quick-deploy.yml -e "component=frontend"
    # ansible-playbook quick-deploy.yml -e "component=all"
    component: "{{ component | default('all') }}"
    
    # ç’°å¢ƒè¨­å®š
    env_name: "dev"
    
  tasks:
    - name: "ğŸš€ Quick Deploy - {{ component | upper }}"
      debug:
        msg: |
          â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
          â•‘              YouTube Live Chat Collector                     â•‘
          â•‘                   Quick Deploy                               â•‘
          â•‘                Component: {{ component | upper }}            â•‘
          â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          
          ğŸ“‹ Available Components:
          - lambda: Lambda Functions (4 functions)
          - container: ECS Container (CodeBuild â†’ ECR)
          - frontend: React Frontend (Build â†’ S3)
          - all: Complete system deployment
          
          ğŸ³ Container deployment uses CodeBuild integration
          âš¡ No local Docker required
          ğŸš€ Automated build and ECR push

    # Lambdaé–¢æ•°ã®ã¿ãƒ‡ãƒ—ãƒ­ã‚¤
    - name: Deploy Lambda Functions Only
      include: "playbooks/02-deploy-lambda.yml"
      when: component == "lambda" or component == "all"

    # ã‚³ãƒ³ãƒ†ãƒŠã®ã¿ãƒ‡ãƒ—ãƒ­ã‚¤
    - name: Deploy Container Only
      include: "playbooks/03-deploy-container.yml"
      when: component == "container" or component == "all"

    # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã¿ãƒ‡ãƒ—ãƒ­ã‚¤
    - name: Deploy Frontend Only
      include: "playbooks/04-deploy-frontend.yml"
      when: component == "frontend" or component == "all"

    # å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ‡ãƒ—ãƒ­ã‚¤
    - name: Deploy All Components
      block:
        - include: "playbooks/01-pre-checks.yml"
        - include: "playbooks/02-deploy-lambda.yml"
        - include: "playbooks/03-deploy-container.yml"
        - include: "playbooks/04-deploy-frontend.yml"
        - include: "playbooks/05-post-verification.yml"
      when: component == "all"

    - name: "âœ… Quick Deploy Completed"
      debug:
        msg: |
          âœ… Quick Deploy for {{ component | upper }} completed successfully!
          
          ğŸ’¡ Available components:
          - lambda: Lambda functions only
          - container: ECS container only
          - frontend: React.js frontend only
          - all: Complete system deployment
          
          ğŸ“‹ Usage examples:
          ansible-playbook quick-deploy.yml -e "component=lambda"
          ansible-playbook quick-deploy.yml -e "component=container"
          ansible-playbook quick-deploy.yml -e "component=frontend"
          ansible-playbook quick-deploy.yml -e "component=all"
